1     0000              MODULE planet_motion_asm_asm
2     0000              LINE 0, "planet_motion_asm.asm"
0     0000              
1     0000              ;
2     0000              ;  Calculate planet utility functions
3     0000              ;
4     0000              
5     0000              ;==============================================================================
6     0000              ;       REV SUBROUTINE
7     0000              ;
8     0000              ;       ensure the result is 0 < x < 360 degrees
9     0000              ;
10    0000              
11    0000              SECTION code_user
12    0000              
13    0000              IF __MATH_AM9511
14    0000              
15    0000              EXTERN asm_am9511_fmul_callee
16    0000              EXTERN asm_am9511_fsub_callee
17    0000              EXTERN asm_am9511_floor_fastcall
18    0000              
19    0000              PUBLIC _rev
20    0000              
21    0000              ._rev
22    0000                  push de                         ; x
23    0000                  push hl
24    0000                  ld bc,0x3b36                    ; (1/360.0)
25    0000                  push bc
26    0000                  ld bc,0x0b61
27    0000                  push bc
28    0000                  call asm_am9511_fmul_callee     ; (1/360.0 * x)
29    0000                  call asm_am9511_floor_fastcall
30    0000                  ld bc,0x43b4                    ; (360.0)
31    0000                  push bc
32    0000                  ld bc,0x0000
33    0000                  push bc
34    0000                  call asm_am9511_fmul_callee     ; (360.0) * floor(1/360.0 * x)
35    0000                  call asm_am9511_fsub_callee     ; x - (360.0) * floor(1/360.0 * x)
36    0000                  ret
37    0000              
38    0000              ENDIF
39    0000              
40    0000              IF __MATH_MATH32
41    0000              
42    0000              EXTERN m32_fsmul_callee
43    0000              EXTERN m32_fssub_callee
44    0000              EXTERN m32_floor_fastcall
45    0000              
46    0000              PUBLIC _rev
47    0000              
48    0000              ._rev
49    0000  D5              push de                 ; x
50    0001  E5              push hl
51    0002  01 36 3B        ld bc,0x3b36            ; (1/360.0)
52    0005  C5              push bc
53    0006  01 61 0B        ld bc,0x0b61
54    0009  C5              push bc
55    000A  CD 00 00        call m32_fsmul_callee   ; (1/360.0 * x)
56    000D  CD 00 00        call m32_floor_fastcall
57    0010  01 B4 43        ld bc,0x43b4            ; (360.0)
58    0013  C5              push bc
59    0014  01 00 00        ld bc,0x0000
60    0017  C5              push bc
61    0018  CD 00 00        call m32_fsmul_callee   ; (360.0) * floor(1/360.0 * x)
62    001B  CD 00 00        call m32_fssub_callee   ; x - (360.0) * floor(1/360.0 * x)
63    001E  C9              ret
64    001F              
65    001F              ENDIF
66    001F              
67    001F              ;==============================================================================
68    001F              
69    001F              
